# run_experiment.py 文件总结

## 功能概述
`run_experiment.py` 是自动化实验管理模块，负责执行大规模的设计空间探索实验，支持多参数组合的自动化测试和结果收集。

## 主要功能

### 参数处理系统

#### 参数分类
- **`split_parameters()`**: 将实验参数分为固定参数和范围参数
- **固定参数**: 在所有实验中保持不变的参数
- **范围参数**: 需要遍历多个值的参数
- **智能识别**: 根据参数值数量自动分类

#### 参数组合生成
- **`compute_parameter_combinations()`**: 生成所有可能的参数组合
- **笛卡尔积**: 计算所有范围参数的组合
- **实验命名**: 自动生成唯一的实验名称
- **组合管理**: 处理复杂的参数组合逻辑

### 实验执行引擎

#### 实验生成流程
1. **参数解析**: 分离固定和变化参数
2. **组合计算**: 生成所有参数组合
3. **输入生成**: 为每个组合生成输入文件
4. **实验执行**: 运行RapidChiplet分析
5. **结果收集**: 保存和分析结果

#### 实验命名机制
- **基础名称**: 来自实验配置
- **参数后缀**: 基于参数值生成
- **列表处理**: 特殊处理列表类型参数
- **唯一性保证**: 确保实验名称的唯一性

### 实验配置结构

#### 支持的参数类型
- **字符串参数**: 拓扑类型、路由算法等
- **数值参数**: 网格规模、芯片数量等
- **布尔参数**: 开关选项
- **列表参数**: 复杂配置选项

#### 实验指标
- **metrics**: 指定要计算的性能指标
- 支持的指标：
  - `area_summary`: 面积分析
  - `power_summary`: 功耗分析
  - `link_summary`: 链路分析
  - `cost`: 成本分析
  - `latency`: 延迟分析
  - `throughput`: 吞吐量分析
  - `booksim_simulation`: BookSim仿真

## 命令行接口
```bash
python3 run_experiment.py -e experiments/<experiment_file>
```

### 参数说明
- `-e`: 实验配置文件路径

## 实验配置示例

### 网格规模实验
```json
{
    "grid_scale": ["4x4", "8x8", "16x16"],
    "topology": ["mesh", "torus"],
    "routing_algorithm": ["splif", "sptmr"]
}
```

### 工艺技术实验
```json
{
    "technology": ["tech_1", "tech_2"],
    "base_chiplet_area": [50, 74, 100],
    "phy_area": [0.5, 0.85, 1.2]
}
```

## 输出管理

### 结果文件组织
- **实验名称**: 基于参数组合生成
- **存储位置**: `results/` 目录
- **文件格式**: JSON格式
- **命名规则**: 实验名称 + 参数后缀

### 日志和进度
- **执行进度**: 实时显示当前实验状态
- **错误处理**: 记录失败的实验和原因
- **统计信息**: 总实验数、完成数、失败数

## 性能优化

### 执行效率
- **批量处理**: 优化大量实验的执行
- **内存管理**: 及时释放不需要的数据
- **并行支持**: 支持并行执行（可选）

### 资源管理
- **磁盘空间**: 监控结果文件大小
- **计算时间**: 估算总执行时间
- **错误恢复**: 支持中断后继续执行

## 使用场景

### 设计空间探索
- 网络拓扑比较
- 工艺技术评估
- 路由算法性能
- 芯片配置优化

### 性能基准测试
- 不同规模下的性能
- 配置参数的影响
- 瓶颈识别
- 优化建议

### 学术研究
- 参数敏感性分析
- 设计权衡研究
- 性能建模
- 验证理论假设

## 技术特点

### 自动化程度
- 完全自动化的实验流程
- 无需手动干预
- 智能的参数处理
- 完整的结果管理

### 可扩展性
- 支持任意参数组合
- 灵活的实验配置
- 易于添加新的指标
- 支持自定义实验逻辑

### 可靠性
- 完善的错误处理
- 实验状态跟踪
- 结果验证机制
- 恢复和重试功能

## 依赖关系

### 核心模块
- `helpers.py`: 工具函数
- `generate_inputs.py`: 输入生成
- `rapidchiplet.py`: 分析引擎

### 外部库
- `argparse`: 命令行解析
- `copy`: 对象复制
- Python标准库

## 最佳实践

### 实验设计
- 合理的参数范围选择
- 避免过多的组合爆炸
- 考虑计算资源限制
- 设计有意义的对比实验

### 结果分析
- 系统性的结果整理
- 统计分析的应用
- 可视化结果展示
- 结论的可靠性验证